rules:
  - id: wp-return-true-rest-route
    languages:
      - php
    severity: ERROR
    message: These API endpoints have their 'permission_callback' set to
      '__return_true', meaning that there's no authorization.
    pattern-either:
      - pattern: register_rest_route(..., ..., [..., 'permission_callback' =>
          '__return_true' , ...], ...)
      - pattern: |
          register_rest_route(..., ..., [ ..., 
          [..., 'permission_callback' =>
          '__return_true' , ...], 
          ...], ...)
    metadata:
      category: security
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: HIGH
      subcategory:
        - audit
      technology:
        - Wordpress Plugins
      references:
        - (Page 8)
          https://www.wordfence.com/wp-content/uploads/2021/07/Common-WordPress-Vulnerabilities-and-Prevention-Through-Secure-Coding-Best-Practices.pdf
      owasp:
        - A01:2021 - Broken Access Control
      cwe:
        - "CWE-285: Improper Authorization"
      vulnerability_class:
        - Improper Authorization
